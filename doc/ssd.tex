\documentclass[letterpaper]{article}
\usepackage{graphicx}
\usepackage{fullpage}
\usepackage{color}
\usepackage[english]{babel}
\usepackage{appendix}
\usepackage{tabularx}


\newcommand{\HRule}{\rule{5cm}{0.1mm}}
\begin{document}
\begin{center}


% Upper part of the page
%\includegraphics[\textwidth]{SSDDTemplateA2-img1}\\[1cm]    

\textsc{\Large University of Idaho}\\[0.2cm]

\textsc{\Large CS481: Senior Design}\\[2cm]


% Title
{ \LARGE \bfseries Idaho Department of Health and Welfare}\\[0.4cm]
{ \huge \bfseries Time, Accounting, and Reporting System}\\[1.0cm]
{ \normalsize \emph{ prepared for}}\\[0.5cm]
{ \normalsize Don Moreaux}\\[0.5cm]
\HRule \\[3cm]

% Authors and supervisors
\begin{minipage}{0.4\textwidth}
\begin{flushleft} \large
\emph{Authors:}\\
Scott Beddall\\
Brett Hitchcock\\
Chaylo Laurino\\
Alex Nilson
\end{flushleft}
\end{minipage}
\begin{minipage}{0.4\textwidth}
\begin{flushright} \large
\emph{Advisors:} \\
Greg Donohoe\\
\bigskip
\bigskip
\bigskip
\bigskip
\end{flushright}
\end{minipage}

% Bottom of the page
{\large \today}

\end{center}
\pagebreak
\tableofcontents

\pagebreak
\section{\bfseries{Introduction}}
\subsection{\bfseries{Identification}}
This Software Design Document pertains to the Idaho Department of Health and Welfare Time, Accounting, and Reporting System. Project development for Fall Semester, 2011 is executed by Scott Beddall, Brett Hitchcock, Chaylo Laurino, and Alex Nilson. The advisor for the project from the University of Idaho is Gregory Donohoe. Our project sponsor and primary client from the Idaho Department of Health and Welfare is Don Moroeux. 
\subsection{\bfseries{Document Purpose, Scope, and Intended Audience}}
\subsubsection{Document Purpose}
This document's sole purpose is to outline the scope of Idaho TARS. This outline includes, but is not limited to:
\begin{itemize}
\item Development Decisions and Rationale.
\item Architectural Specifications.
\item Detailed Design Information.
\item Locations of Other Project Resources.
\end{itemize}
\subsubsection{Intended Audience for Document}
Though the TARS is to be fully prototyped by the end of 2011, it will not be completed. With that being the case, this document is aimed at any future developers or users of Idaho TARS. 

\subsection{\bfseries{Software Purpose, Scope, and Intended Users}}
\subsubsection{Software Purpose}
Idaho TARS is intended to provide time and resource tracking for contractor/non-contractor work efforts within the Idaho Department of Welfare. Work efforts must be added to time-bounded project PCA codes and approved by users with sufficient privileges. Project summaries, cost totals,user logs, and other information will then be available within TARS.     

\subsubsection{Software Scope/Context}
The Idaho Department of Health and Welfare currently is utilizing a resource called Mariner for project management. The IDHW's needs, however, are significantly less than the capabilities that Mariner provides. Portfolio and Resource Management, Planning, and other features of Mariner are being paid for, but being left unused. This is where the creation of the Time, Accounting, and Reporting System is merited. 

\subsubsection{Intended Users for the Software}
Intended Users of Idaho TARS are the staff and employees of the Idaho Department of Health and Welfare as well as their contractors.

\subsection{\bfseries{Definitions, Acronyms, and Abbreviations}}
This table will expand dramatically when documenting the MVC modules.
\begin{center}
\begin{tabular}{| l | p{10cm} |}
\hline
MVC & Model View Controller. A design pattern used for content focused websites. \\ \hline
TARS & Time, Accounting, and Reporting System. \\ \hline
PCA Code & Position Classification Allocation Code. \\ \hline
SQL & Structured Query Language. Used for input and retrieval of data from a SQL database.\\ \hline
IDHW & Idaho Deparment of Health and Welfare \\ \hline
Work Effort & A project. Has one or more assigned PCA Codes and a list of associated work tasks.\\ \hline
MVC & Model-View-Controller.\\ \hline
Database Connection String & A formatted line of text that contains all location information for a SQL database. \\
\hline
\end{tabular}
\end{center}

\subsection{\bfseries{Document Overview}}
Section 2 describes software constraints imposed by the operation environment, system requirements, and user characteristics. After this it will identify the system stakeholders and list/describe their concerns.  \\
\\
Section 3 of this document describes the system and software
architecture from several viewpoints, including, but not limited to,
the developer{\textquoteright}s view and the user{\textquoteright}s
view.\\
\\
Section 4 provides detailed design descriptions for every component
defined in the architectural view(s). \\
\\
Sections 5 provides traceability information connecting the original specifications
(referenced above) to the architectural components and design entities identified in this document.\\
\\
Section 6 and beyond are appendices including original information and communications used to create this document.
\section{\bfseries{Software Requirements, Constraints, and User Characteristics}}
%\input{requirements_doc.tex}
Check the requirements\_summary.docx for an extensive list of requirements.
\section{Software Architecture}
\subsection{Server Architecture - Microsoft Internet Information Services 7} 
One of the IDHW's requirements for the this project is the use of Windows Server infrastructure. In this case the TARS development team will use Microsoft IIS7. Microsoft's Internet Information Services server is a modular, intuitive server application. New considerations must now be applied, however. IIS7, being a Microsoft product, uses Microsoft development software. Namely:
\begin{itemize}
\item C\# 
\item ASP.NET
\item Visual Basic/VB.NET
\item .NET Development Framework
\end{itemize} 
TARS will be developed using all these technologies, as well as the IIS7 Model-View-Controller application. The MVC application will be described in detail in the next section.

\subsection{Model-View-Controller}
Most of the heavy-lifting for TARS will be present in the display and interaction with large amounts of data. This problem is what the Model-View-Controller design pattern was created for. The idea is that each word in the acronym: Model, View, and Controller each represent a component that handles a different aspect of the display process.\\
\\
Advantage of Model-View-Controller architecture:
\begin{itemize}
\item Separates the user interface from the logic used in the database.
\item Allows for independant development, testing, and maintenance of these seperate parts of the application.
\end{itemize}
\subsubsection{Controller}
A Controller receives input from the user and converts it to instructions for the Model and View components. Most MVC's use the first argument after the website URL as the controller call. In our case:\\
\begin{verbatim}
http://idahotars.com/home
\end{verbatim}
Will load the ``home'' controller.
\subsubsection{Model}
The Model manages database queries and assembles data for use elsewhere in the MVC.
\subsubsection{View}
View renders the data received from the Model into a viewable web page.
\subsection{SQL2008 Database}
Though IIS can utilize any format of SQL Database, the IDHW requires that TARS use SQL2008. Any queries made by the MVC will be carried out by the "Model" component of the MVC. \\
\includegraphics[scale=0.8]{../design/images/mvc.png}
\subsection{Active Directory}
The IDHW uses Microsoft Active Directory for their user authentification. With that infrastructure already in place, it is logical to use the same for Idaho TARS. To authenticate users of TARS, there will be three new Active Directory groups added: TARSAdmin, TARSManager, and TARSUser. If a given user is part of any of these three groups, they will be allowed access to TARS based upon their group.

\subsection{Security}
While Idaho TARS will be used internally, there is still a security risk. The system may not be dealing with any highly confidential info, but TARS will have access to government resources like the IDHW Active Directory and I-Time interfaces. To prevent easy exploitation of the TARS databases, all queries to the database will be centralized in Model. This will will not only make the team's code simpler, but also make it more secure. Centralized queries allow us to easily adopt a strong security stance. Namely, all input from anywhere on the browser will be treated as ``tainted.'' This tainted input will not be used for any queries on the SQL2008 database until it has been filtered.


\subsection{Browser Interface}
Though it is probably already indicated by the server architecture, the development team must make it clear that this software is being developed for a web interface. This will eliminate many of the dependencies that are inherent to a system launched from a binary. The development team is developing this project to meet the following end system requirements:
\begin{itemize}
\item 1024x768 monitor resolution
\item Google Chrome
\item Mozilla Firefox
\item Internet Explorer 7 and up
\item Safari
\item Compliant with W3C standards
\end{itemize}
\section{Design Descriptions}
\subsection{Model-View-Controller Modules}
\subsubsection{Global Scripts and Config Files}

\subsubsection{Controllers}
These controllers do not yet have a finalized set of associated functions and variables. When these are complete a full description will reside here.
\begin{itemize}
\item HomeController
\item UserController
\item ManagerController
\item AdminController
\end{itemize}
The home controller our default page in the case that a user is not logged in. It provides the entry point. \\
\\
UserController inherits from the default MVC Controller class as well as providing basic functionality for a normal user.\\
\\
ManagerController inherits from UserController, but adds a couple more abilities that managers need as per the requirements specification.\\
\\
AdminController inherits from ManagerController, inheriting all functionality as well as providing any and all administrative functions that are needed by TARS admin. Having these inherited privileges ensures that forced permission traversals will be almost impossible.\\ 
\begin{verbatim}
Home Controller //Default controller called when visited TARS 
                //for the first time or when not logged in.

User Controller
 -> ManagerController
  -> AdminController

\end{verbatim}
\subsubsection{Models}
\begin{itemize}
\item AccountModels (provided by IIS7 MVC)
\item History
\item Hours
\item PcaCode
\item PCAWE
\item WorkEffort
\end{itemize}
These items do not inherit from the default Model class. In addition, each class has an associated DbContext class in the same file. Example:
\begin{verbatim}
public class PCA_CodeDBContext : DbContext
{
   public DbSet<PcaCode> PCA_CodeList { get; set; }
}
\end{verbatim}
These connections are not conventional classes or objects. To indicate this, their naming conventions are slightly more verbose. A DbContext creates a new context instance that utilizes an existing Database Connection String (located inside web.config) to create a connection to a SQL Database.
\subsubsection{Views}
\begin{itemize}
\item Every controller has an associated View. Located in their respective folders. Manager example:
\begin{verbatim}
Views/Manager/___.cshtml
\end{verbatim}
\end{itemize}
\subsection{SQL2008 Database Schema and Interface Description}
As mentioned above in the Software Architecture section, TARS will use a SQL2008 database to store all interactions other than User Info (handled by Active Directory). Before outlining the Database Schema, it would be wise to fully describe the thought process of the development team.\\
\\
Stripped down to its most base parts, TARS is simply a database interface through which users can log and retrieve hours to and from work efforts. These ``Work Efforts'' are simply general projects that can have hours of contractor/non-contractor work added to their totals. For instance, there might be a Work Effort that is assigned its own unique ID and whos description is ``Document the latest changes to the TARS SDD.'' Any employees who wish to log their hours will find the Work Effort's ID, add their hours along with other relevant data, and submit their entire timesheet for approval. \\
\\
The Work Effort to ``Document the latest changes to the TARS SDD.'' now has hours logged on it and waiting for approval. A user with the correct Active Directory permissions (part of group TARSManager or TARSAdmin) can now go check the status of the Work Effort, and approve any pending hours waiting on it. The development team has chosen to add all hours, approved or not, to the Work Effort's database table. A simple boolean present as a column in the table will ensure that filtering by approved/unapprooved will be a simple task.\\
\\
Unfortunately, the process is not done. Now that a Work Effort has hours charged to it, how can the accounting department charge these expenses? The simple answer is, they can't yet. To provide that functionality, PCA Codes must be assigned. This introduces another database table, as one PCA Code may have multiple Work Effort associations; just as one Work Effort may be associated with multiple PCA Codes.\\
\\
One final note about the Work Efforts and PCA Codes is needed. The requirements state that they both must be time-bounded, capable of early expiration, and renewable. \\
\\
Through discussion of the above situations and processes, the development team settled on the following database schema. These are no final by any means, as a design is rarely finalized before development has commenced.\\
\\
Addendum for 11/1/2011. The stakeholders introduced the concept of ``tasks.'' There will be a default set of tasks for every work effort, but members of the ``administrator'' Active Directory group will have the ability to add or remove these ``tasks'' from a given work effort. Instead of having a separate ``tasks'' table for each work effort, the TARS team members will simply store the list of tasks in a comma separated string; using string manipulation to retrieve, edit, and read the list.

\subsubsection{TARS Database Schema}
\includegraphics[scale=0.4]{../design/images/class_diagram_1.png}



\subsection{Naming Conventions}
All defined classes and objects will use capitalized camelcase, with their first letter a capital as well.\\
\\
Local Variables and instances of classes will use camelcase also, neglecting the capitalization of their first letter.
\begin{verbatim}
class Manager : Controller
{
    public int id;
    public bool approved = FALSE;
    public string hoursType;
}
\end{verbatim}

\section{Tracability Information}
All effort on the project may be tracked via the project GitHub repository: github.com/ICBM/TARS\\
\\
The project website resides at: http://seniordesign.engr.uidaho.edu/2011-2012/CostManagement/\\
\\ 
Client requirements changes will be handled via email. Current progress on requirements as well as the requirements changelog is available at: github.com/ICBM/TARS/blob/master/doc/requirements\_summary.docx\\
\section{Appendix A: Use Cases} 
More might be required here.

\paragraph{Login}
\begin{enumerate}
\item Click the "Login" button
\item Enter username and password
\item Hit Enter or click "Submit"
\item System authenticates and redirects to home page.
\end{enumerate}

\paragraph{Adding new PCA code.}
\begin{enumerate}
\item Select "Add PCA"
\item System loads PCA form
\item Fill in form, including time bounds for the PCA code
\item Press "Submit"
\item System updates tables and redirects to new PCA display page
\item A request to the financial department will be automatically dispatched. PCA codes are not actually generated by TARS.
\end{enumerate}

\paragraph{Deactivating PCA code}
\begin{enumerate}
\item Select desired PCA code
\item System loads PCA display page
\item Click deactivate
\item Confirm deactivation.
\item System updates tables and locks PCA code.
\end{enumerate}

\paragraph{Adding Work Effort}
\begin{enumerate}
\item Select "Add Work Effort"
\item System loads Work Effort form
\item Fill in form
\item Associate desired PCA code or codes, if multiple PCA codes are chosen a percentage of work effort may be set for each
\item Associate entity or entities
\item Click "Submit"
\item System updates tables and redirects
\end{enumerate}

\paragraph{Updatinging Work Effort}
\begin{enumerate}
\item Select "Update Work Effort"
\item System loads Work Effort form
\item Make Changes in form
\item Click "Submit"
\item System updates tables and redirects
\end{enumerate}

\paragraph{Adding Hours}
\begin{enumerate}
\item Select "Add Hours"
\item System loads Work Effort Selection form
\item Select Work Effort
\item System loads Hours form
\item Fill in form or select "replicate" to fill with previous weeks data
\item Click "Submit"
\item System updates tables and redirects
\end{enumerate}

\paragraph{Approving Hours}
\begin{enumerate}
\item Select "Approve Hours"
\item System loads hour approval form and fills with items needing approval
\item Select item
\item Select "Approve" or "Disapprove"
\item System updates tables and redirects back to hour approval form
\end{enumerate}

\paragraph{Adding Tasks}
\begin{enumerate}
\item Select "Add Tasks"
\item System loads Work Effort Selection form
\item Select Work Effort
\item System loads Task List form
\item Add desired tasks
\item Click "Submit"
\item System updates tables and redirects
\end{enumerate}

\paragraph{Edit/Update Employee/Contractor Data}
\begin{enumerate}
\item Select desired entity
\item System pulls data from database and loads Entity Form
\item Edit/Update as desired
\item Click "Update"
\item System updates table and redirects.
\end{enumerate}

\paragraph{View History}
\begin{enumerate}
\item Select "View History"
\item System loads History Search form
\item Enter Search Criteria
\item System loads Search Result form and fill with data
\end{enumerate}

\paragraph{The system must allow for future time entry}
\begin{enumerate}
\item Select ``Add Work Effort''
\item Fill in form, making sure to add the effort to the correct date.
\item Click ``Submit''
\end{enumerate}

\paragraph{All data for reporting shall be extracted via external source (EDW. Excel, etc.).}
\begin{enumerate}
\item Under a given PCA code or work effort, select ``Get Data Report''.
\item The system will then generate a copy of the data in EDW or Excel format.
\item User saves the copy at a destination of their choosing.
\end{enumerate}

\paragraph{Must allow users to create a view of their I-Time timesheet.}
\begin{enumerate}
\item User logs in.
\item On the user's personal page, select ``Get I-Time Report''.
\item The system will then generate a copy of the data for viewing.
\end{enumerate}

\paragraph{Must have a sort and group function that allows work effort to be grouped by application, division, manager, etc.}
\begin{enumerate}
\item User logs in.
\item User selects ``My Work Efforts''
\item System generates list of all work efforts related.
\item User selects to sort by name, application, etc.
\item System sorts and redisplays work efforts in the proper order.
\end{enumerate}

\paragraph{The system must allow a user the ability to create a custom view of the data.}
\begin{enumerate}
\item User selects a PCA code or Work Effort code
\item User selects ``Get Data Report''.
\item User enters custom settings and hits ``Select''.
\item System generates report.
\end{enumerate}

\paragraph{Must allow users to easily size windows}
\begin{enumerate}
\item User resizes browser, which will resize the web interface.
\end{enumerate}

\paragraph{The system shall provide search/find functionality to locate work efforts, with minimal amount of navigation (less than 5 clicks per important action)}
\begin{enumerate}
\item User logs in.
\item User navigates to a work effort by...
\begin{itemize}
  \item Clicking on a link in the ``My Recent Work'' bar.
  \item Entering a Work Effort code or PCA code in the Search bar on the top.
    \end{itemize}
\end{enumerate}

\section{Appendix B: Deliverables}

At the end of the first semester the TARS team turned over the following deliverables to be passed on to the next semester’s team for completion; This Design Document, Client Requirement Documents, Meeting Minutes, Tutorials, Prototype Source Files, Requirements Summary, and our GitHub Repository.\\
\\
This Design Document contains all of the conceptual and technical designs for this project.  It also includes various Client restrictions on software and platform for the project.  For further details please read the document.\\
\\
The Client Requirement Documents outline the Client’s desired functionality of the system.  It is broken down into 6 parts: PCA, Data, Reporting, View, Security, Navigation, and Workflow.  This document was provided to us by the Client.  It has been updated several times as requirements have been added or altered.\\
\\
All of the Minutes of our meetings with our clients as also been added.  They show the changes in the requirements over time and contain clarifications to questions we or the client may have had during the course of the project.\\
\\
Extensive trial and error was involved in setting up our machines to be viable development platforms based on the restrictions laid out by the Client.  To prevent our successors from having to deal with the same problems we dealt with we have created several tutorials to help smooth the process for them.\\
\\
We have managed to produce a functioning prototype.  It includes all the primary models and controllers but has only rudimentary views and testing.  The source code has been provided as has a Microsoft Visual Studio build.  The full details concerning the functional state of the prototype in relation to the full project requirements are laid out in the Requirements Summary document.\\
\\
The Requirements Summary is a combination of the Client Requirement Document and a full summary of our prototypes functionality.  It explains in detail the current status of every requirement.\\
\\
The final deliverable we have is our GitHub Repository.  It has been the primary location for our collaborative work.  It is an open source repository as the client desired us to make the source code public.  It costs 12 dollars a month and will need to be transferred to the new team as soon as they take up the project.\\
\\


\section{Appendix C: Reference Links}
Unit Testing ASP.NET MVC\\
\small{http://msdn.microsoft.com/en-us/magazine/dd942838.aspx}\\
\\
SQL2008 integration w/ IIS7 MVC reference\\
\small{http://blog.evonet.com.au/post/Setting-up-SQL-Server-2008-for-an-ASPNET-website-on-IIS-70.aspx}\\
\\
SQL2008 St15udio Manager\\
\small{http://www.microsoft.com/download/en/details.aspx?id=7593}\\
\\
SQL2008 Server\\
\small{http://www.microsoft.com/download/en/details.aspx?id=1695}\\
\\
Apache Directory Server (LDAP stand-in for Active Directory)\\
\small{http://directory.apache.org/apacheds/1.5/}\\
\\
Apache Directory Studio (Essential Client for Managing ApacheDS)\\
\small{http://directory.apache.org/studio/}\\
\\
Write an LDAP interface in C\#\\
\small{http://www.youcanlearnseries.com/programming\%20Tips/CSharp/LDAPReader.aspx}\\
\\



\end{document} 
